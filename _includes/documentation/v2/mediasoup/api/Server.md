## Server
{: #Server}

A `server` runs and manages a set of mediasoup worker child processes that handle media realtime-communications (ICE, DTLS, RTP, RTCP, DataChannel, etc.).


### Dictionaries
{: #Server-dictionaries}

<section markdown="1">

#### ServerSettings
{: #Server-ServerSettings .code}

<div markdown="1" class="table-wrapper L3 M5">

Field                    | Type    | Description   | Required | Default
------------------------ | ------- | ------------- | -------- | ---------
`numWorkers`             | Integer | Number of child worker processes. | No | Number of CPU cores in the host
`logLevel`               | String  | Logging level for logs generated by the media worker subprocesses (check the [Debugging](/documentation/v2/mediasoup/debugging/) documentation). Valid values are "debug", "warn", "error". | No | "debug"
`logTags`                | Array   | Log tags for debugging. Check the list of available tags in [Debugging](/documentation/v2/mediasoup/debugging/) documentation. | No | `[ ]`
`rtcIPv4`          | String\|Boolean | IPv4 for RTC. Valid values are a IPv4, `true` (auto-detect) and `false` (disabled). | No | `true`
`rtcIPv6`          | String\|Boolean | IPv6 for RTC. Valid values are a IPv6, `true` (auto-detect) and `false` (disabled). | No | `true`
`rtcAnnouncedIPv4` | String | Announced IPv4 for RTC. Useful for deployments in server with private IP such as AWS. Valid values are a IPv4. | No |
`rtcAnnouncedIPv6` | String | Announced IPv6 for RTC. Useful for deployments in server with private IP such as AWS. Valid values are a IPv6. | No |
`rtcMinPort`             | Integer | Minimun RTC port. | No | 10000
`rtcMaxPort`             | Integer | Maximum RTC port. | No | 59999
`dtlsCertificateFile`    | String  | Path to the DTLS certificate. If unset, a random certificate is generated. | No |
`dtlsPrivateKeyFile`     | String  | Path to the DTLS private key. If unset, a random certificate is generated. | No |

</div>

#### ServerUpdateableSettings
{: #Server-ServerUpdateableSettings .code}

<div markdown="1" class="table-wrapper L3">

Field                    | Type    | Description   | Required | Default
------------------------ | ------- | ------------- | -------- | ---------
`logLevel`               | String  | Logging level for logs generated by the media worker subprocesses (check the [Debugging](/documentation/v2/mediasoup/debugging/) documentation). Valid values are "debug", "warn", "error". | No |
`logTags`                | Array   | Log tags for debugging. Check the list of available tags in [Debugging](/documentation/v2/mediasoup/debugging/) documentation. | No |

</div>

</section>


### Properties
{: #Server-properties}

<section markdown="1">

#### server.closed
{: #server-closed .code}

* Read only

A boolean indicating whether the `server` has been closed.

#### server.numWorkers
{: #server-numWorkers .code}

* Read only

The number of available workers (it matches `numWorkers` in [ServerSettings](#Server-ServerSettings) if given).

</section>


### Methods
{: #Server-methods}

<section markdown="1">

#### server.close()
{: #server-close .code}

Closes the `server`, including all its `rooms`, and triggers a [`close`](#server-on-close) event.

#### server.updateSettings(settings)
{: #server-updateSettings .code}

Updates the `server` settings in runtime. Just a subset of the full [ServerSettings](#Server-ServerSettings) can be updated.

<div markdown="1" class="table-wrapper L3">

Argument   | Type    | Description | Required | Default 
---------- | ------- | ----------- | -------- | ----------
`settings` | [ServerUpdateableSettings](#Server-ServerUpdateableSettings) | Server settings. | No |

</div>

#### server.Room(mediaCodecs, [options])
{: #server-Room .code}

Creates and returns a new [Room](#Room) instance.

<div markdown="1" class="table-wrapper L3">

Argument      | Type    | Description | Required | Default 
------------- | ------- | ----------- | -------- | ----------
`mediaCodecs` | sequence&lt;[RoomMediaCodec](#Room-RoomMediaCodec)&gt; | Room media codecs. | Yes |
`options` | Object | Optional room options | No |

</div>

`options` allows the following items:

<div markdown="1" class="table-wrapper L3">

Field        | Type    | Description   | Required | Default
------------ | ------- | ------------- | -------- | ---------
`workerIdx`  | Integer | Worker index (from 0 to `server.numWorkers` - 1) to let the app select a specific worker to handle this room. If unset, the worker is chosen incrementally. | No |

</div>

Usage example:

```javascript
const mediaCodecs =
[
  {
    kind        : "audio",
    name        : "opus",
    clockRate   : 48000,
    channels    : 2,
    parameters  :
    {
      useinbandfec : 1
    }
  },
  {
    kind      : "video",
    name      : "VP8",
    clockRate : 90000
  },
  {
    kind       : "video",
    name       : "H264",
    clockRate  : 90000,
    parameters :
    {
      "packetization-mode"      : 1,
      "profile-level-id"        : "42e01f",
      "level-asymmetry-allowed" : 1
    }
  }
];

const room = server.Room(mediaCodecs);
```

</section>


### Events
{: #Server-events}

The `Server` class inherits from [EventEmitter](https://nodejs.org/api/events.html#events_class_eventemitter).

<section markdown="1">

#### server.on("close")
{: #server-on-close .code}

Emitted when the `server` is closed.

#### server.on("newroom", fn(room))
{: #server-on-newroom .code}

Emitted when a new `room` is created.

<div markdown="1" class="table-wrapper L3">

Argument | Type    | Description   
-------- | ------- | ----------------
`room`   | [Room](#Room) | New `room`.

</div>

</section>
